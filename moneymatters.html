<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>MoneyMate — Save Smarter</title>
<style>
  :root {
    --navy: #001f3f;
    --darkblue: #002b5c;
    --lightblue: #0074D9;
    --mutedblue: #b0c4de;
    --glass: rgba(255, 255, 255, 0.03);
    --white: #fff;
  }
  * {
    box-sizing: border-box;
  }
  body {
    margin: 0; 
    font-family: Inter, ui-sans-serif, system-ui, sans-serif;
    background: linear-gradient(180deg, var(--navy) 0%, var(--darkblue) 100%);
    color: var(--white);
    min-height: 100vh;
    display: flex;
    flex-direction: column;
  }
  header {
    position: sticky;
    top: 0;
    background: rgba(0, 31, 63, 0.9);
    backdrop-filter: blur(8px);
    padding: 16px 22px;
    display: flex;
    align-items: center;
    gap: 16px;
    border-bottom: 1px solid rgba(255 255 255 / 0.05);
    z-index: 20;
  }
  .logo {
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 12px;
    user-select: none;
  }
  .logo .mark {
    background: var(--lightblue);
    color: var(--white);
    font-weight: 700;
    font-size: 20px;
    width: 44px;
    height: 44px;
    border-radius: 10px;
    display: flex;
    justify-content: center;
    align-items: center;
  }
  .logo .text {
    display: flex;
    flex-direction: column;
    line-height: 1;
  }
  .logo .text .title {
    font-weight: 700;
    font-size: 20px;
  }
  .logo .text .subtitle {
    font-size: 12px;
    color: var(--mutedblue);
  }
  nav {
    margin-left: auto;
    display: flex;
    gap: 8px;
  }
  button.nav-btn {
    background: transparent;
    border: none;
    color: var(--mutedblue);
    padding: 8px 12px;
    border-radius: 8px;
    font-weight: 600;
    cursor: pointer;
    transition: background-color 0.3s ease;
  }
  button.nav-btn.active,
  button.nav-btn:hover {
    background: var(--lightblue);
    color: var(--white);
  }

  main.container {
    max-width: 1000px;
    margin: 22px auto 44px;
    width: 90vw;
    display: grid;
    gap: 22px;
    flex-grow: 1;
  }
  section.view {
    display: none;
  }
  section.view.active {
    display: block;
  }

  /* Cards */
  .card {
    background: var(--darkblue);
    padding: 18px 20px;
    border-radius: 12px;
    box-shadow: 0 0 20px rgba(0 0 0 / 0.3);
  }
  h1, h2, h3, h4 {
    margin-top: 0;
  }
  p, ul {
    line-height: 1.5;
  }
  ul {
    padding-left: 20px;
  }

  /* About card on home */
  #about-home {
    margin-top: 18px;
  }

  /* Star Badge */
  #star-badge {
    background: var(--lightblue);
    color: var(--white);
    padding: 14px 18px;
    border-radius: 14px;
    font-weight: 700;
    font-size: 18px;
    width: fit-content;
    user-select: none;
    display: flex;
    align-items: center;
    gap: 10px;
    box-shadow: 0 0 10px var(--lightblue);
  }

  /* Inputs & Labels */
  label {
    display: block;
    margin-bottom: 6px;
    color: var(--mutedblue);
    font-size: 13px;
  }
  input[type="number"],
  input[type="text"],
  textarea,
  select {
    width: 100%;
    padding: 10px 14px;
    border-radius: 8px;
    border: 1px solid rgba(255 255 255 / 0.1);
    background: var(--glass);
    color: var(--white);
    font-size: 15px;
    outline: none;
  }
  input[type="number"]::-webkit-inner-spin-button,
  input[type="number"]::-webkit-outer-spin-button {
    -webkit-appearance: none;
    margin: 0;
  }

  /* Buttons */
  button.primary {
    background: var(--lightblue);
    border: none;
    color: var(--white);
    padding: 12px 18px;
    border-radius: 12px;
    font-weight: 700;
    cursor: pointer;
    margin-top: 12px;
    transition: background-color 0.3s ease;
  }
  button.primary:hover {
    background: #005bb5;
  }
  button.small {
    padding: 6px 10px;
    font-size: 14px;
    border-radius: 8px;
  }

  /* Tables */
  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 10px;
    font-size: 14px;
    word-break: break-word;
  }
  th, td {
    padding: 8px 10px;
    border-bottom: 1px solid rgba(255 255 255 / 0.05);
    text-align: left;
  }
  th {
    background: rgba(255 255 255 / 0.05);
  }
  input.table-input {
    width: 100%;
    background: transparent;
    border: none;
    color: var(--white);
    font-size: 14px;
    padding: 4px 6px;
    border-radius: 6px;
    outline: none;
  }
  input.table-input:focus {
    background: rgba(255 255 255 / 0.1);
  }

  /* Chat */
  .chat-container {
    display: flex;
    flex-direction: column;
    height: 480px;
  }
  .messages {
    flex-grow: 1;
    overflow-y: auto;
    padding: 14px;
    display: flex;
    flex-direction: column;
    gap: 10px;
    background: var(--panel, var(--darkblue));
    border-radius: 12px;
  }
  .msg {
    max-width: 75%;
    padding: 10px 14px;
    border-radius: 14px;
    line-height: 1.4;
    word-wrap: break-word;
  }
  .msg.user {
    background: rgba(255 255 255 / 0.15);
    align-self: flex-end;
  }
  .msg.bot {
    background: rgba(0 116 217 / 0.3);
    align-self: flex-start;
  }
  .chat-input {
    margin-top: 10px;
    display: flex;
    gap: 10px;
  }
  .chat-input input[type=text] {
    flex-grow: 1;
    padding: 12px 14px;
    font-size: 15px;
    border-radius: 12px;
    border: none;
    outline: none;
  }

  /* Responsive */
  @media (max-width: 700px) {
    main.container {
      width: 95vw;
    }
    .chat-container {
      height: 360px;
    }
    table, th, td {
      font-size: 13px;
    }
    button.nav-btn {
      padding: 6px 8px;
      font-size: 14px;
    }
  }
</style>
</head>
<body>
<header>
  <div class="logo" onclick="navigate('home')">
    <div class="mark">MM</div>
    <div class="text">
      <div class="title">MoneyMate</div>
      <div class="subtitle">Save smarter. Start now.</div>
    </div>
  </div>
  <nav>
    <button class="nav-btn active" data-route="home" onclick="navigate('home')">Home</button>
    <button class="nav-btn" data-route="tools" onclick="navigate('tools')">Tools</button>
    <button class="nav-btn" data-route="chat" onclick="navigate('chat')">Chatbot</button>
    <button class="nav-btn" data-route="about" onclick="navigate('about')">About</button>
  </nav>
</header>
<main class="container">
  <!-- Home -->
  <section id="view-home" class="view active">
    <div class="card">
      <h1>Win at saving — simple habits, real results</h1>
      <p>A modern toolkit for young earners: tax estimator, budget builder, and a quick tips chatbot to keep you on track.</p>
      <button class="primary" onclick="navigate('tools')">Open Tools</button>
    </div>
    <div id="star-badge" class="card" style="margin-top:20px;">
      <span id="star-emoji">⭐</span>
      <span id="star-count">0</span> stars — <span id="star-rank">Beginner Saver</span>
    </div>
    <div id="about-home" class="card">
      <h2>About MoneyMate</h2>
      <p>MoneyMate is your friendly sidekick for mastering your money. Whether you want to estimate your taxes, build a budget that works, or get quick money-saving tips, MoneyMate’s got you covered.</p>
      <p>Track your savings, earn stars, and level up your financial game with our easy-to-use tools designed for South African earners.</p>
    </div>
  </section>

  <!-- Tools -->
  <section id="view-tools" class="view">
    <div class="card">
      <h2>South African Tax Estimator</h2>
      <p>Enter your annual income to estimate your tax and take-home pay.</p>
      <label for="tax-income">Annual Income (ZAR):</label>
      <input type="number" min="0" id="tax-income" placeholder="e.g., 300000" />
      <button class="primary" onclick="calculateTax()">Calculate Tax</button>
      <table id="tax-result" style="margin-top: 12px; display:none;">
        <thead>
          <tr>
            <th>Tax Bracket</th>
            <th>Rate</th>
            <th>Tax Payable (ZAR)</th>
          </tr>
        </thead>
        <tbody id="tax-result-body"></tbody>
        <tfoot>
          <tr style="font-weight:700;">
            <td colspan="2">Total Tax</td>
            <td id="tax-total"></td>
          </tr>
          <tr style="font-weight:700; color: var(--lightblue);">
            <td colspan="2">Estimated Take Home</td>
            <td id="tax-takehome"></td>
          </tr>
        </tfoot>
      </table>
    </div>

    <div class="card" style="margin-top: 28px;">
      <h2>Budget Builder</h2>
      <p>Add your income and expenses. Save more, earn stars!</p>
      <table id="budget-table">
        <thead>
          <tr>
            <th>Description</th>
            <th>Amount (ZAR)</th>
            <th>Type</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody id="budget-items"></tbody>
        <tfoot>
          <tr>
            <td><input type="text" id="new-desc" placeholder="E.g. Salary" /></td>
            <td><input type="number" id="new-amount" placeholder="E.g. 15000" min="0" /></td>
            <td>
              <select id="new-type">
                <option value="income" selected>Income</option>
                <option value="expense">Expense</option>
              </select>
            </td>
            <td><button class="primary small" onclick="addBudgetItem()">Add</button></td>
          </tr>
        </tfoot>
      </table>
      <div id="budget-summary" style="margin-top: 20px; font-weight: 700;">
        <p>Total Income: ZAR <span id="total-income">0</span></p>
        <p>Total Expenses: ZAR <span id="total-expenses">0</span></p>
        <p>Savings: ZAR <span id="total-savings">0</span> (<span id="savings-percent">0</span>%)</p>
      </div>
      <div id="star-msg" style="margin-top: 12px; font-size: 16px; font-weight: 700;"></div>
    </div>
  </section>

  <!-- Chat -->
  <section id="view-chat" class="view">
    <div class="card chat-container">
      <h2>MoneyMate Quick Tips Chatbot</h2>
      <div class="messages" id="chat-messages"></div>
      <form id="chat-form" class="chat-input" autocomplete="off">
        <input type="text" id="chat-input" placeholder="Ask for money-saving tips..." required />
        <button class="primary small" type="submit">Send</button>
      </form>
    </div>
  </section>

  <!-- About (separate page if needed) -->
  <section id="view-about" class="view">
    <div class="card">
      <h2>About MoneyMate</h2>
      <p>MoneyMate is your friendly sidekick for mastering your money. Whether you want to estimate your taxes, build a budget that works, or get quick money-saving tips, MoneyMate’s got you covered.</p>
      <p>Track your savings, earn stars, and level up your financial game with our easy-to-use tools designed for South African earners.</p>
      <p>Created with ❤️ for young earners wanting to take control of their finances.</p>
    </div>
  </section>
</main>

<script>
  // Navigation logic
  const views = document.querySelectorAll('section.view');
  const navButtons = document.querySelectorAll('button.nav-btn');

  function navigate(route) {
    views.forEach(v => v.classList.remove('active'));
    navButtons.forEach(b => b.classList.remove('active'));

    document.getElementById('view-' + route).classList.add('active');
    document.querySelector(`button.nav-btn[data-route=${route}]`).classList.add('active');
  }

  // TAX ESTIMATOR LOGIC
  const taxBands = [
    { min: 0, max: 226000, rate: 0.18 },
    { min: 226001, max: 353100, rate: 0.26 },
    { min: 353101, max: 488700, rate: 0.31 },
    { min: 488701, max: 641400, rate: 0.36 },
    { min: 641401, max: 817600, rate: 0.39 },
    { min: 817601, max: 1731600, rate: 0.41 },
    { min: 1731601, max: Infinity, rate: 0.45 },
  ];

  function calculateTax() {
    const income = parseFloat(document.getElementById('tax-income').value);
    if (isNaN(income) || income < 0) {
      alert('Please enter a valid positive income');
      return;
    }
    let totalTax = 0;
    const tbody = document.getElementById('tax-result-body');
    tbody.innerHTML = '';

    taxBands.forEach(band => {
      if (income > band.min) {
        const taxableAmount = Math.min(income, band.max) - band.min;
        const taxPayable = taxableAmount * band.rate;
        totalTax += taxPayable;

        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${band.min.toLocaleString()} - ${band.max === Infinity ? '∞' : band.max.toLocaleString()}</td>
          <td>${(band.rate * 100).toFixed(0)}%</td>
          <td>R ${taxPayable.toFixed(2)}</td>
        `;
        tbody.appendChild(tr);
      }
    });

    document.getElementById('tax-total').textContent = 'R ' + totalTax.toFixed(2);
    document.getElementById('tax-takehome').textContent = 'R ' + (income - totalTax).toFixed(2);
    document.getElementById('tax-result').style.display = 'table';
  }

  // BUDGET BUILDER LOGIC
  let budgetItems = JSON.parse(localStorage.getItem('moneyMateBudgetItems')) || [];
  let starCount = parseInt(localStorage.getItem('moneyMateStars')) || 0;

  function saveBudget() {
    localStorage.setItem('moneyMateBudgetItems', JSON.stringify(budgetItems));
  }

  function saveStars() {
    localStorage.setItem('moneyMateStars', starCount);
    updateStarBadge();
  }

  function updateStarBadge() {
    const starCountEl = document.getElementById('star-count');
    const starRankEl = document.getElementById('star-rank');
    const starEmojiEl = document.getElementById('star-emoji');
    starCountEl.textContent = starCount;

    let rank = '';
    let emoji = '';

    if (starCount >= 20) {
      rank = '🏆 Money Legend';
      emoji = '🏆';
    } else if (starCount >= 10) {
      rank = '💎 Master Saver';
      emoji = '💎';
    } else if (starCount >= 5) {
      rank = '💰 Smart Saver';
      emoji = '💰';
    } else {
      rank = '💼 Beginner Saver';
      emoji = '⭐';
    }

    starRankEl.textContent = rank;
    starEmojiEl.textContent = emoji;
  }

  function renderBudget() {
    const tbody = document.getElementById('budget-items');
    tbody.innerHTML = '';

    budgetItems.forEach((item, index) => {
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td><input type="text" class="table-input" value="${item.description}" onchange="updateBudgetItem(${index}, 'description', this.value)" /></td>
        <td><input type="number" min="0" class="table-input" value="${item.amount}" onchange="updateBudgetItem(${index}, 'amount', this.value)" /></td>
        <td>
          <select onchange="updateBudgetItem(${index}, 'type', this.value)">
            <option value="income" ${item.type === 'income' ? 'selected' : ''}>Income</option>
            <option value="expense" ${item.type === 'expense' ? 'selected' : ''}>Expense</option>
          </select>
        </td>
        <td><button class="primary small" onclick="removeBudgetItem(${index})">Remove</button></td>
      `;
      tbody.appendChild(tr);
    });

    updateBudgetSummary();
  }

  function updateBudgetItem(index, field, value) {
    if(field === 'amount') {
      value = parseFloat(value);
      if(isNaN(value) || value < 0) value = 0;
    }
    budgetItems[index][field] = value;
    saveBudget();
    updateBudgetSummary();
  }

  function removeBudgetItem(index) {
    budgetItems.splice(index, 1);
    saveBudget();
    renderBudget();
  }

  function addBudgetItem() {
    const descInput = document.getElementById('new-desc');
    const amountInput = document.getElementById('new-amount');
    const typeInput = document.getElementById('new-type');

    const desc = descInput.value.trim();
    const amount = parseFloat(amountInput.value);
    const type = typeInput.value;

    if(!desc) {
      alert('Please enter a description.');
      return;
    }
    if(isNaN(amount) || amount <= 0) {
      alert('Please enter a positive amount.');
      return;
    }

    budgetItems.push({ description: desc, amount, type });
    saveBudget();
    renderBudget();

    descInput.value = '';
    amountInput.value = '';
    typeInput.value = 'income';
  }

  function updateBudgetSummary() {
    const totalIncome = budgetItems
      .filter(i => i.type === 'income')
      .reduce((a,b) => a + b.amount, 0);

    const totalExpenses = budgetItems
      .filter(i => i.type === 'expense')
      .reduce((a,b) => a + b.amount, 0);

    const totalSavings = Math.max(totalIncome - totalExpenses, 0);
    const savingsPercent = totalIncome > 0 ? (totalSavings / totalIncome * 100) : 0;

    document.getElementById('total-income').textContent = totalIncome.toFixed(2);
    document.getElementById('total-expenses').textContent = totalExpenses.toFixed(2);
    document.getElementById('total-savings').textContent = totalSavings.toFixed(2);
    document.getElementById('savings-percent').textContent = savingsPercent.toFixed(1);

    // Star reward logic - earn 1 star per successful saving (>= 20%)
    const starMsgEl = document.getElementById('star-msg');
    if(savingsPercent >= 20 && totalIncome > 0) {
      starMsgEl.textContent = "🎉 Great job! You saved at least 20%. You earn 1 star! ⭐";
      // Only add star if last added saving was not counted - store last saved star count for session
      if(!sessionStorage.getItem('savedStarForThisBudget')) {
        starCount++;
        saveStars();
        sessionStorage.setItem('savedStarForThisBudget', 'true');
      }
    } else {
      starMsgEl.textContent = "Try to save at least 20% of your income to earn stars.";
      // Reset session marker so next good budget can earn star
      sessionStorage.removeItem('savedStarForThisBudget');
    }
  }

  // Initialize
  renderBudget();
  updateStarBadge();

  // CHATBOT LOGIC
  const chatForm = document.getElementById('chat-form');
  const chatMessages = document.getElementById('chat-messages');

  const tips = [
    "Set clear savings goals and track them weekly.",
    "Automate your savings to make it effortless.",
    "Cut back on unnecessary subscriptions and services.",
    "Cook meals at home instead of eating out.",
    "Use cash envelopes for better spending control.",
    "Review your budget monthly and adjust as needed.",
    "Avoid impulse buys by waiting 24 hours before purchasing.",
    "Increase your emergency fund gradually.",
    "Look for free entertainment options in your area.",
    "Shop during sales and use discounts wisely."
  ];

  function addMessage(text, sender='bot') {
    const msg = document.createElement('div');
    msg.classList.add('msg', sender);
    msg.textContent = text;
    chatMessages.appendChild(msg);
    chatMessages.scrollTop = chatMessages.scrollHeight;
  }

  chatForm.addEventListener('submit', e => {
    e.preventDefault();
    const userInput = chatForm.elements['chat-input'].value.trim();
    if (!userInput) return;
    addMessage(userInput, 'user');
    chatForm.reset();

    // Simple keyword-based reply
    let reply = "Here's a quick money-saving tip for you:";
    const lowerInput = userInput.toLowerCase();
    if(lowerInput.includes('save')) reply = tips[0];
    else if(lowerInput.includes('automate')) reply = tips[1];
    else if(lowerInput.includes('cut')) reply = tips[2];
    else if(lowerInput.includes('cook')) reply = tips[3];
    else if(lowerInput.includes('cash')) reply = tips[4];
    else if(lowerInput.includes('budget')) reply = tips[5];
    else if(lowerInput.includes('impulse')) reply = tips[6];
    else if(lowerInput.includes('emergency')) reply = tips[7];
    else if(lowerInput.includes('free')) reply = tips[8];
    else if(lowerInput.includes('sale')) reply = tips[9];

    addMessage(reply);
  });
</script>
</body>
</html>
